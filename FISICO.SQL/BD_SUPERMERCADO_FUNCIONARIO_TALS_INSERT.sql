USE BD_SUPERMERCADO_FUNCIONARIO_PRODUTO_CONSUMIDOR;

INSERT INTO SUPERMERCADO (	SUP_CNPJ, 
							SUP_RAZAO_SOCIAL, 
                            SUP_TELEFONE,
                            SUP_EMAIL,
                            SUP_ENDERECO_LOGADOURO,
                            SUP_ENDERECO_NUMERO,
                            SUP_ENDERECO_CIDADE,
                            SUP_ENDERECO_ESTADO)
VALUES 					(	"12345678000101",
							"Supermercado Grick",
                            "199999999",
                            "gricktambau@email.com",
                            "Grick Street",
                            "10000",
                            "TambaCity",
                            "SP");

INSERT INTO SUPERMERCADO (SUP_CNPJ, SUP_RAZAO_SOCIAL, SUP_TELEFONE, SUP_EMAIL, SUP_ENDERECO_LOGADOURO, SUP_ENDERECO_NUMERO, SUP_ENDERECO_CIDADE, SUP_ENDERECO_ESTADO)
VALUES
("22345678000102", "Supermercado BomPreço", "11988887777", "contato@bompreco.com", "Rua das Laranjeiras", "450", "Campinas", "SP"),
("32345678000103", "Supermercado PagueMenos", "11999995555", "sac@paguemenos.com", "Avenida Brasil", "980", "Piracicaba", "SP"),
("42345678000104", "Supermercado Central", "19987654321", "central@supercentral.com", "Rua XV de Novembro", "120", "Limeira", "SP"),
("52345678000105", "Supermercado Econômico", "19999887766", "atendimento@economico.com", "Av. da Saudade", "75", "Mogi Guaçu", "SP");

INSERT INTO PRODUTO ( 	PRO_CODIGO_BARRAS,
						PRO_NOME,
                        PRO_PESO,
                        PRO_QUANTIDADE,
                        PRO_PRECO,
                        PRO_DATA_VALIDADE)
VALUES				(	"7891234567890",
						"Arroz 5kg",
						5.0,
                        500,
                        26.90,
                        "2025-12-25");

INSERT INTO PRODUTO (PRO_CODIGO_BARRAS, PRO_NOME, PRO_PESO, PRO_QUANTIDADE, PRO_PRECO, PRO_DATA_VALIDADE)
VALUES
("7894561237891", "Feijão Carioca 1kg", 1.0, 300, 7.49, "2026-02-15"),
("7896543219872", "Açúcar Refinado 2kg", 2.0, 250, 8.29, "2026-04-30"),
("7893216549873", "Óleo de Soja 900ml", 0.9, 400, 6.79, "2026-01-10"),
("7899876543214", "Café Torrado e Moído 500g", 0.5, 150, 12.50, "2026-06-20");

INSERT INTO CONSUMIDOR	(	CON_CPF,
							CON_NOME,
                            CON_TELEFONE,
                            CON_EMAIL)
VALUES					( 	"47486114800",
							"Gabriel Evaristo",
                            "19994154097",
                            "gabriel.santana@sp.senai.br");

INSERT INTO CONSUMIDOR (CON_CPF, CON_NOME, CON_TELEFONE, CON_EMAIL)
VALUES
("12345678901", "Mariana Oliveira", "11988887766", "mariana.oliveira@email.com"),
("98765432100", "Lucas Andrade", "19997776655", "lucas.andrade@email.com"),
("45678912322", "Fernanda Lima", "11999112233", "fernanda.lima@email.com"),
("85236974155", "João Pedro Ramos", "19988223344", "joao.ramos@email.com");

INSERT INTO FUNCIONARIO (	FUN_CPF,
							FUN_NOME,
                            FUN_DATA_NASCIMENTO,
                            FUN_TELEFONE,
                            FUN_EMAIL,
                            FUN_CARTEIRA_TRABALHO,
                            FUN_BANCO_AGENCIA,
                            FUN_BANCO_CONTA,
                            FUN_DATA_ADMISSAO,
                            FUN_JORNADA_TRABALHO,
                            FK_SUP_CNPJ)
VALUES 					( 	"98765432100",
							"José Vanderlei",
                            "1985-03-12",
                            "11987654321",
                            "ze_vanderlei@email.com",
                            "carteira_ze_vanderlei.pdf",
                            "1234",
                            "56789",
                            "2020-01-15",
                            "44 horas",
                            "12345678000101");
                            
INSERT INTO FUNCIONARIO (FUN_CPF, FUN_NOME, FUN_DATA_NASCIMENTO, FUN_TELEFONE, FUN_EMAIL, FUN_CARTEIRA_TRABALHO, FUN_BANCO_AGENCIA, FUN_BANCO_CONTA, FUN_DATA_ADMISSAO, FUN_JORNADA_TRABALHO, FK_SUP_CNPJ)
VALUES
("74125896300", "Ana Paula Souza", "1990-07-22", "11991234567", "ana.paula@email.com", "carteira_ana_paula.pdf", "2356", "99874", "2021-03-10", "40 horas", "22345678000102"),

("85214796311", "Marcos Vinícius Pereira", "1988-11-05", "19993456789", "marcos.vinicius@email.com", "carteira_marcos_vinicius.pdf", "1478", "33221", "2019-08-01", "44 horas", "32345678000103"),

("96325874122", "Carla Mendes", "1995-02-28", "11998887766", "carla.mendes@email.com", "carteira_carla_mendes.pdf", "3254", "11223", "2022-06-20", "36 horas", "42345678000104"),

("35715948633", "Rogério Nascimento", "1982-09-14", "19995554433", "rogerio.nascimento@email.com", "carteira_rogerio_nascimento.pdf", "4567", "88776", "2018-12-05", "44 horas", "52345678000105");

INSERT INTO SUPERMERCADO_PRODUTO (FK_SUP_CNPJ, FK_PRO_ID)
VALUES
("12345678000101", 1),  -- Supermercado Grick -> Arroz 5kg
("22345678000102", 2),  -- BomPreço -> Feijão Carioca
("32345678000103", 3),  -- PagueMenos -> Açúcar Refinado
("42345678000104", 4),  -- Central -> Óleo de Soja
("52345678000105", 5);  -- Econômico -> Café Torrado e Moído

INSERT INTO PRODUTO_CONSUMIDOR (FK_CON_CPF, FK_PRO_ID)
VALUES
("47486114800", 1),  -- Gabriel Evaristo comprou Arroz
("12345678901", 2),  -- Mariana Oliveira comprou Feijão
("98765432100", 3),  -- Lucas Andrade comprou Açúcar
("45678912322", 4),  -- Fernanda Lima comprou Óleo de Soja
("85236974155", 5);  -- João Pedro Ramos comprou Café

SELECT * FROM SUPERMERCADO; 

/* 
CONSULTAR O AUMENTO DE R$ 2,00 NO PREÇO DOS PRODUTOS COM PREÇO ATUAL >= R$ 5,00
*/
SELECT PRO_NOME AS "NOME",
       PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
       PRO_PRECO AS "PREÇO ATUAL", 
       TRUNCATE ((PRO_PRECO + 2),2) AS "PREÇO COM AJUSTE DE R$S 2,00" 
FROM   PRODUTO 
WHERE  PRO_PRECO >= 5;

/* 
CONSULTAR A REDUÇÃO DE R$ 1,00 NO PREÇO DOS PRODUTOS COM PREÇO ATUAL  ABAIXO DE R$ 5,00
*/
SELECT PRO_NOME AS "NOME",
       PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
       PRO_PRECO AS "PREÇO ATUAL",
       TRUNCATE ((PRO_PRECO - 1),2) AS "PREÇO COM REDUÇÃO DE R$ 1,OO"
FROM   PRODUTO
WHERE  PRO_PRECO <=10;

/*
CONSULTAR COMO SERIA APLICAR UM DESCONTO DE 10% EM TODOS OS PRODUTOS
*/

SELECT PRO_NOME AS "NOME",
       PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
       PRO_PRECO AS "PREÇO ATUAL",
       (PRO_PRECO - (PRO_PRECO * 0.1)) AS "PREÇO COM DESCONTO DE 10%"
FROM PRODUTO;

/*AJUSTAR O ESTOQUE DO PRIMEIRO PRODUTO, DIVIDINDO PELA METADE*/
SELECT PRO_ID,
       PRO_NOME,
       PRO_CODIGO_BARRAS,
       PRO_QUANTIDADE
FROM PRODUTO;

UPDATE PRODUTO 
SET    PRO_QUANTIDADE = PRO_QUANTIDADE/2
WHERE PRO_ID =1;

/*CONSULTAR TODOS OS PRODUTOS QUE TENHAM DATA DE VALIDADE ENTRE SETEMBRO DE 2025 E DEZEMBRO DE 2025*/
SELECT PRO_NOME AS "NOME",
	   PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
       PRO_DATA_VALIDADE AS "DATA DE VALIDADE"
FROM   PRODUTO
WHERE  PRO_DATA_VALIDADE BETWEEN '2025-09-01' AND '2025-12-31';

/*CONSULTAR TODOS OS PRODUTOS QUE TENHAM PREÇO MAIOR QUE 10 REAIS OU MENOR QUE 4 REAIS*/
SELECT PRO_NOME AS "NOME",
	   PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
       PRO_PRECO AS "PREÇO"
FROM PRODUTO
WHERE PRO_PRECO >= 10 OR PRO_PRECO <= 4;

/*CONSULTAR OS DDS E TELEFONE DOS CONSUMIDORES SEPARADAMENTE*/
SELECT CON_NOME 	AS "NOME DO CONSUMIDOR",
	   CON_CPF  	AS "CPF DO CONSUMIDOR",
       SUBSTRING(CON_TELEFONE,2,2) AS "DDD DO TELEFONE",
       SUBSTRING(CON_TELEFONE,5,9) AS "NUMERO DO TELEFONE"
FROM CONSUMIDOR;

/*GERAR UMA FRASE CONCATENANDO:
RAZÃO SOCIAL, CNPJ, TELEFONE E EMAIL*/
SELECT
    CONCAT(
        'RAZAO SOCIAL: ',
        CONCAT(
            SUP_RAZAO_SOCIAL,
            CONCAT(
                ' | CNPJ ',
                CONCAT(
                    SUP_CNPJ,
                    CONCAT(
                        ' | TELEFONE ',
                        CONCAT(
                            SUP_TELEFONE,
                            CONCAT(
                                ' | EMAIL ',
                                SUP_EMAIL
                            )
                        )
                    )
                )
            )
        )
    ) AS FRASE
FROM SUPERMERCADO;

/*GERAR UMA CONSULTA QIE VERIFICA O PESO DOS PRODUTOS. 
RETORNAR: NOME, CODIGO DE BARRAS, QUANTIDADE, PESO E DATA DE VALIDADE
REGRAS:
1) PESO <= 5: PESO BAIXO
2) PESO > 5 E PESO <= 50: PESO MÉDIO
3) PESO > 50: PESO ALTO
*/

SELECT PRO_NOME AS "NOME DO PRODUTO",
       PRO_CODIGO_BARRAS AS "CODIGO DE BARRAS",
       PRO_QUANTIDADE AS "QUANTIDADE",
       PRO_DATA_VALIDADE AS "DATA DE VALIDADE",
       PRO_PESO AS "PESO DO PRODUTO",
       CASE 
	       WHEN PRO_PESO <= 5 THEN "PESO BAIXO"
           WHEN PRO_PESO > 5 AND PRO_PESO <= 50 THEN "PESO MÉDIO"
           WHEN PRO_PESO > 50 THEN "PESO ALTO"
		END AS "CLASSIFICAÇÃO DO PESO"
FROM PRODUTO;

/*CONTAR QUANTOS CONSUMIDORES TEMOS CADASTRADOS*/
SELECT COUNT(*)
FROM CONSUMIDOR;

SELECT COUNT(*)
FROM SUPERMERCADO;

SELECT COUNT(*)
FROM FUNCIONARIO;

SELECT COUNT(*)
FROM PRODUTO;

/*PREÇO TOTAL DE TODOS OS PRODUTOS CADASTRADOS*/
SELECT SUM(PRO_PRECO)
FROM PRODUTO;

SELECT CONCAT("R$ ", TRUNCATE(SUM(PRO_PRECO),2)) AS "SOMA TOTAL"
FROM PRODUTO;

/*CALCULAR A MÉDIA DE PREÇO DOS PRODUTOS*/
SELECT AVG(PRO_PRECO)
FROM PRODUTO;

SELECT CONCAT("R$ ", TRUNCATE(AVG(PRO_PRECO),2)) AS "MÉDIA DE PREÇO"
FROM PRODUTO;

/*SELECIONAR O PRODUTO MAIS CARO*/
SELECT MAX(PRO_PRECO)
FROM PRODUTO;

/*SELECIONAR O ESTOQUE COM MAIOR QUANTIDADE*/
SELECT MAX(PRO_QUANTIDADE)
FROM PRODUTO;

/*SELECIONAR O ESTOQUE COM MAIS BARATO*/
SELECT MIN(PRO_PRECO)
FROM PRODUTO;

/*SELECIONAR O ESTOQUE COM MENOR QUANTIDADE*/
SELECT MIN(PRO_QUANTIDADE)
FROM PRODUTO;

/*SELECIONAR A DATA E HORA ATUAL*/
SELECT NOW() FROM DUAL;

SELECT FUN_NOME AS "NOME DO FUNCIONÁRIO",
	   DATE_FORMAT(FUN_DATA_NASC, "%d/%m/%Y") as "DATA DE NASCIMENTO",
       TIMESTAMPDIFF(YEAR,FUN_DATA_NASC,NOW()) AS "IDADE"
FROM FUNCIONARIO;

/*FUNÇÕES MATEMÁTICAS:
ABS - VALOR ABSOLUTO DE UM NÚMERO
ROUND - ARREDONDAR
POWER - POTÊNCIA*/
SELECT ABS(-10),
       ROUND(PRO_PRECO) AS "PREÇO ARREDONDADO",
       POWER(PRO_PRECO,2) AS "PREÇO ELEVADOS AO QUADRADO"
FROM PRODUTO;

/*UPPER, LOWER, TRIM*/
SELECT UPPER(FUN_NOME) AS "MAIÚSCULAS",
	   LOWER(FUN_NOME) AS "MAIÚSCULAS",
       TRIM("            EU") AS "TIRANDO ESPAÇOS"
FROM FUNCIONARIO;

SELECT PRO_QUANTIDADE,
	   COUNT(*) AS "Repetições"
FROM PRODUTO
GROUP BY PRO_QUANTIDADE;

/*UNION*/
SELECT FUN_NOME,
       FUN_CPF
FROM FUNCIONARIO
UNION
SELECT FUN_NOME,
       FUN_CPF
FROM FUNCIONARIO;

SELECT * FROM PRODUTO;

SELECT PRO_NOME
FROM PRODUTO
UNION
SELECT "Arroz Branco Tipo 1"
FROM DUAL
UNION
SELECT "Iorgut do bob esponja"
FROM DUAL;

SELECT PRO_NOME
FROM PRODUTO
UNION ALL
SELECT "Arroz Branco Tipo 1"
FROM DUAL
UNION ALL
SELECT "Iorgut do bob esponja"
FROM DUAL;

/*SELECT COM WHERE*/
SELECT FUN_NOME AS "NOME DO FUNCIONARIO",
	   FUN_CPF AS "CPF DO FUNCIONARIO",
       FUN_DATA_NASC AS "DATA DE NASC DO FUNCIONARIO",
       TIMESTAMPDIFF(YEAR,FUN_DATA_NASC,NOW()) AS "IDADE"
FROM FUNCIONARIO
WHERE TIMESTAMPDIFF(YEAR,FUN_DATA_NASC,NOW()) >=25
AND TIMESTAMPDIFF(YEAR,FUN_DATA_NASC,NOW()) <=35;

/*RETORNAR OS FUNCIONARIOS,CONSUMIDORES E SUPERMERCADO COM EMAIL IGUAL A HOTMAIL OU OUTLOOK*/
SELECT 
    CON_NOME AS "NOME",
    CON_CPF AS "CPF/CNPJ",
    CON_TELEFONE AS "TELEFONE",
    CON_EMAIL AS "EMAIL",
    'CONSUMIDOR' AS "TIPO"
FROM CONSUMIDOR
WHERE UPPER(CON_EMAIL) LIKE '%HOTMAIL%'
OR UPPER(CON_EMAIL) LIKE '%EMAIL%'

UNION

SELECT 
    FUN_NOME AS "NOME",
    FUN_CPF AS "CPF/CNPJ",
    FUN_TELEFONE AS "TELEFONE",
    FUN_EMAIL AS "EMAIL",
    'FUNCIONARIO' AS "TIPO"
FROM FUNCIONARIO
WHERE UPPER(FUN_EMAIL) LIKE '%HOTMAIL%'
OR UPPER(FUN_EMAIL) LIKE '%EMAIL%'

UNION

SELECT 
    SUP_RAZAO_SOCIAL AS "NOME",
    SUP_CNPJ AS "CPF/CNPJ",
    SUP_TELEFONE AS "TELEFONE",
    SUP_EMAIL AS "EMAIL",
    'SUPERMERCADO' AS "TIPO"
FROM SUPERMERCADO
WHERE UPPER(SUP_EMAIL) LIKE '%HOTMAIL%'
OR UPPER(SUP_EMAIL) LIKE '%EMAIL%';

/*CROSS JOIN*/
SELECT   PRODUTO.PRO_NOME AS "NOME",
         PRODUTO.PRO_CODIGO_BARRAS AS "CÓDIGO DE BARRAS",
         SUPERMERCADO.SUP_RAZAO_SOCIAL AS "RAZAO SOCIAL"
FROM     SUPERMERCADO_PRODUTO
CROSS JOIN SUPERMERCADO 
CROSS JOIN PRODUTO
WHERE PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID
AND SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ;

/*INNER JOIN*/
SELECT PRODUTO_CONSUMIDOR.PCO_ID AS "ID DA COMPRA",
	   PRODUTO.PRO_NOME AS "NOME DO PRODUTO",
       PRODUTO.PRO_CODIGO_BARRAS AS "CODIGO DE BARRAS",
       CONSUMIDOR.CON_NOME AS "NOME DO CONSUMIDOR",
       CONSUMIDOR.CON_CPF AS "CPF DO CONSUMIDOR"
FROM PRODUTO_CONSUMIDOR
INNER JOIN PRODUTO ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID)
INNER JOIN CONSUMIDOR ON (PRODUTO_CONSUMIDOR.FK_CON_CPF = CONSUMIDOR.CON_CPF);

/*EXERCICIO 1*/
SELECT FUNCIONARIO.FUN_NOME AS "NOME DO FUNCIONARIO",
       SUPERMERCADO.SUP_RAZAO_SOCIAL AS "NOME DO MERCADO"
FROM FUNCIONARIO
INNER JOIN SUPERMERCADO ON (FUNCIONARIO.FK_SUP_CNPJ = SUPERMERCADO.SUP_CNPJ);

/*EXERCICIO 2*/
SELECT  PRODUTO.PRO_NOME AS "PRODUTO",
        SUPERMERCADO.SUP_RAZAO_SOCIAL AS "RAZÃO SOCIAL"
FROM SUPERMERCADO_PRODUTO
INNER JOIN PRODUTO ON (PRODUTO.PRO_ID=SUPERMERCADO_PRODUTO.FK_PRO_ID)
INNER JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ=SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

/*LEFT JOIN*/
INSERT INTO PRODUTO   (PRO_CODIGO_BARRAS,
					   PRO_NOME,
                       PRO_PESO,
                       PRO_QUANTIDADE,
                       PRO_PRECO,
                       PRO_DATA_VALIDADE)
VALUES                  ("33333333",
						"KITKAT",
                        "30",
                        "1500",
                        4.50,
                        "2026-01-01");
                        
SELECT PRODUTO.PRO_NOME,
       SUPERMERCADO.SUP_RAZAO_SOCIAL
FROM PRODUTO 
LEFT JOIN SUPERMERCADO_PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
LEFT JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

SELECT PRODUTO.PRO_NOME,
	   SUPERMERCADO.SUP_RAZAO_SOCIAL
FROM PRODUTO 
RIGHT JOIN SUPERMERCADO_PRODUTO ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
RIGHT JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ);

/*SELECT COM LEFT E RIGHT*/
SELECT *
FROM (
		SELECT S.SUP_RAZAO_SOCIAL AS RAZAO_SOCIAL,
			   F.FUN_NOME 		  AS NOME_FUNCIONARIO,
               P.PRO_NOME AS NOME_PRODUTO,
               C.CON_NOME AS NOME_CONSUMIDOR
		FROM SUPERMERCADO S 
        LEFT JOIN FUNCIONARIO F 		  ON (S.SUP_CNPJ = F.FK_SUP_CNPJ)
        LEFT JOIN SUPERMERCADO_PRODUTO SP ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
        LEFT JOIN PRODUTO P 			  ON (SP.FK_PRO_ID = P.PRO_ID)
        LEFT JOIN PRODUTO_CONSUMIDOR PC   ON (P.PRO_ID = PC.FK_PRO_ID)
        LEFT JOIN CONSUMIDOR C 			  ON (PC.FK_CON_CPF = C.CON_CPF)
        UNION 
        SELECT S.SUP_RAZAO_SOCIAL AS RAZAO_SOCIAL,
			   F.FUN_NOME 		  AS NOME_FUNCIONARIO,
               P.PRO_NOME AS NOME_PRODUTO,
               C.CON_NOME AS NOME_CONSUMIDOR
		FROM SUPERMERCADO S 
        RIGHT JOIN FUNCIONARIO F 		  ON (S.SUP_CNPJ = F.FK_SUP_CNPJ)
        RIGHT JOIN SUPERMERCADO_PRODUTO SP ON (S.SUP_CNPJ = SP.FK_SUP_CNPJ)
        RIGHT JOIN PRODUTO P 			  ON (SP.FK_PRO_ID = P.PRO_ID)
        RIGHT JOIN PRODUTO_CONSUMIDOR PC   ON (P.PRO_ID = PC.FK_PRO_ID)
        RIGHT JOIN CONSUMIDOR C 			  ON (PC.FK_CON_CPF = C.CON_CPF)
)SELECT_EXTERNO
ORDER BY SELECT_EXTERNO.RAZAO_SOCIAL ASC,
         SELECT_EXTERNO.NOME_FUNCIONARIO DESC,
         SELECT_EXTERNO.NOME_PRODUTO ASC,
         SELECT_EXTERNO.NOME_CONSUMIDOR DESC;
;

/*EXERCÍCIO 1*/
SELECT  SUPERMERCADO.SUP_RAZAO_SOCIAL  AS "RAZÃO SOCIAL",
  PRODUTO.PRO_NOME     AS "PRODUTO"
FROM SUPERMERCADO_PRODUTO
INNER JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ=SUPERMERCADO_PRODUTO.FK_SUP_CNPJ)
INNER JOIN PRODUTO   ON (PRODUTO.PRO_ID=SUPERMERCADO_PRODUTO.FK_PRO_ID);

/*EXERCÍCIO 2*/
SELECT  FUNCIONARIO.FUN_NOME    AS "FUNCIONÁRIO",
  SUPERMERCADO.SUP_RAZAO_SOCIAL  AS "SUPERMERCADO"
FROM SUPERMERCADO
INNER JOIN FUNCIONARIO ON (SUPERMERCADO.SUP_CNPJ=FUNCIONARIO.FK_SUP_CNPJ);

/*EXERCICIO 3*/
SELECT  CONSUMIDOR.CON_NOME AS "NOME CONSUMIDOR",
  PRODUTO.PRO_NOME AS "NOME PRODUTO"
FROM PRODUTO_CONSUMIDOR
INNER JOIN PRODUTO ON (PRODUTO_CONSUMIDOR.FK_PRO_ID=PRODUTO.PRO_ID)
INNER JOIN CONSUMIDOR ON (PRODUTO_CONSUMIDOR.FK_CON_CPF=CONSUMIDOR.CON_CPF);

/*EXERCICIO 4*/
SELECT  PRODUTO.PRO_NOME AS "NOME PRODUTO",
  CONSUMIDOR.CON_NOME AS "NOME CONSUMIDOR"
FROM PRODUTO_CONSUMIDOR
INNER JOIN PRODUTO ON (PRODUTO_CONSUMIDOR.FK_PRO_ID=PRODUTO.PRO_ID)
INNER JOIN CONSUMIDOR ON (PRODUTO_CONSUMIDOR.FK_CON_CPF=CONSUMIDOR.CON_CPF);

/*EXERCICIO 5*/
SELECT  SUPERMERCADO.SUP_RAZAO_SOCIAL  AS "RAZÃO SOCIAL",
  COUNT(PRODUTO.PRO_ID)    AS "QTD PRODUTOS"
FROM SUPERMERCADO_PRODUTO
INNER JOIN PRODUTO   ON (PRODUTO.PRO_ID = SUPERMERCADO_PRODUTO.FK_PRO_ID)
INNER JOIN SUPERMERCADO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ)
GROUP BY SUPERMERCADO.SUP_RAZAO_SOCIAL;
       
/*EXERCÍCIOS 2*/
/*PRIMEIRA BOLOTA*/
SELECT SUPERMERCADO.SUP_RAZAO_SOCIAL AS "SUPERMERCADO",
       PRODUTO.PRO_ID AS "PRODUTO"
FROM   SUPERMERCADO
LEFT JOIN SUPERMERCADO_PRODUTO ON (SUPERMERCADO.SUP_CNPJ = SUPERMERCADO_PRODUTO.FK_SUP_CNPJ)
LEFT JOIN PRODUTO   ON (PRODUTO.PRO_ID=SUPERMERCADO_PRODUTO.FK_PRO_ID);

/*SEGUNDA BOLOTA*/
SELECT F.FUN_NOME AS "NOME DO FUNCIONÁRIO",
       S.SUP_RAZAO_SOCIAL AS "NOME DE SUPERMERCADO"
FROM FUNCIONARIO F
LEFT JOIN SUPERMERCADO S ON (F.FK_SUP_CNPJ = S.SUP_CNPJ);

/*TERCEIRA BOLOTA*/
SELECT 
    CONSUMIDOR.CON_NOME AS "NOME DO CONSUMIDOR",
    PRODUTO.PRO_NOME AS "NOME DO PRODUTO"
FROM CONSUMIDOR
LEFT JOIN PRODUTO_CONSUMIDOR ON (CONSUMIDOR.CON_CPF = PRODUTO_CONSUMIDOR.FK_CON_CPF)
LEFT JOIN PRODUTO ON (PRODUTO_CONSUMIDOR.FK_PRO_ID = PRODUTO.PRO_ID);

/*QUARTA BOLOTA*/
SELECT PRODUTO.PRO_NOME AS "NOME DO PRODUTO",
  CONSUMIDOR.CON_NOME AS "NOME DO PRODUTO"
FROM PRODUTO
LEFT JOIN PRODUTO_CONSUMIDOR ON (PRODUTO.PRO_ID = PRODUTO_CONSUMIDOR.FK_PRO_ID)
LEFT JOIN CONSUMIDOR ON (CONSUMIDOR.CON_CPF = PRODUTO_CONSUMIDOR.FK_CON_CPF);

/*QUINTA BOLOTA*/
SELECT 
    SUPERMERCADO.SUP_RAZAO_SOCIAL AS "NOME DO SUPERMERCADO",
    FUNCIONARIO.FUN_NOME AS "NOME DO FUNCIONÁRIO"
FROM SUPERMERCADO
LEFT JOIN FUNCIONARIO ON (SUPERMERCADO.SUP_CNPJ = FUNCIONARIO.FK_SUP_CNPJ);

/*AGR COM RIGHT JOIN*/
/*PRIMEIRA BOLOTA*/
SELECT S.SUP_RAZAO_SOCIAL,
P.PRO_NOME
FROM SUPERMERCADO S
RIGHT JOIN SUPERMERCADO_PRODUTO SP ON (SP.FK_SUP_CNPJ = S.SUP_CNPJ)
RIGHT JOIN PRODUTO P ON (SP.FK_PRO_ID = P.PRO_ID);

/*SEGUNDA BOLOTA*/
SELECT C.CON_NOME,
       P.PRO_NOME
FROM   CONSUMIDOR C 
RIGHT JOIN PRODUTO_CONSUMIDOR PC ON (PC.FK_CON_CPF = C.CON_CPF)
RIGHT JOIN PRODUTO P   ON (PC.FK_PRO_ID = P.PRO_ID);

/*TERCEIRA BOLOTA*/
SELECT F.FUN_NOME,
       S.SUP_RAZAO_SOCIAL
FROM FUNCIONRIO F 
RIGHT JOIN SUPERMERCADO S ON (S.SUP_CNPJ = F.FK_SUP_CNPJ);

/*QUARTA BOLOTA*/
SELECT S.SUP_RAZAO_SOCIAL,
P.PRO_NOME
FROM SUPERMERCADO S
RIGHT JOIN SUPERMERCADO_PRODUTO SP ON (SP.FK_SUP_CNPJ = S.SUP_CNPJ)
RIGHT JOIN PRODUTO P ON (SP.FK_PRO_ID = P.PRO_ID);

/*QUINTA BOLOTA*/
SELECT C.CON_NOME,
       P.PRO_NOME
FROM   CONSUMIDOR C 
RIGHT JOIN PRODUTO_CONSUMIDOR PC ON (PC.FK_CON_CPF = C.CON_CPF)
RIGHT JOIN PRODUTO P   ON (PC.FK_PRO_ID = P.PRO_ID);